(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"+p+5":function(e,t,r){"use strict";r.r(t),r.d(t,"OrderModule",(function(){return ve}));var a=r("tyNb"),i=r("M0ag"),o=r("M9IT"),c=r("Dh3D"),s=r("+0xr"),n=r("fXoL"),d=r("zE9r"),l=(r("H4X+"),r("tomM"),r("LZqa"),r("AJX/"),r("qnbw"),r("tk/3")),b=r("J9tS");let m=(()=>{class e{constructor(e,t){this.http=e,this.backend=t,this.basicAction="orders/"}getOrders(){return this.backend.getAll(this.basicAction+"?_expand=customer").map(this.extractData).catch(this.handleError)}getOrder(e){return 0===e?d.a.of(this.initializeOrder()):this.backend.getById(`${this.basicAction}${e}?_expand=customer`).map(this.extractData).do(e=>console.log("getOrder: "+JSON.stringify(e))).catch(this.handleError)}deleteOrder(e){return this.backend.delete(`${this.basicAction}${e}`).catch(this.handleError)}saveOrder(e){return 0===e.id?this.createOrder(e):this.updateOrder(e)}createOrder(e){return e.id=void 0,this.backend.create(this.basicAction,e).map(this.extractData).catch(this.handleError)}updateOrder(e){return this.backend.update(`${this.basicAction}${e.id}`,e).map(()=>e).catch(this.handleError)}extractData(e){const t=e.json?e.json():e;return t.data?t.data:t||{}}handleError(e){return console.error(e),d.a.throw(e.json()||"Server error")}initializeOrder(){return{id:0,avatar:null,reference:null,amount:0,products:Array(),orderDate:null,shippedDate:null,shipAddress:{},customerId:0,quantity:0,membership:!1,customer:null}}}return e.\u0275fac=function(t){return new(t||e)(n.Yb(l.a),n.Yb(b.b))},e.\u0275prov=n.Kb({token:e,factory:e.\u0275fac}),e})();var u=r("0IaG"),h=r("dNgK"),p=r("Wp6s"),g=r("/t3+"),f=r("bTqV"),C=r("NFeN"),y=r("kmnG"),T=r("qFsG"),U=r("XhcP"),v=r("MutI"),O=r("3Pt+"),A=r("f0Cb"),I=r("ofXK");function M(e,t){1&e&&(n.Ub(0,"mat-header-cell",39),n.Ac(1," Reference No. "),n.Tb())}function k(e,t){if(1&e&&(n.Ub(0,"mat-cell"),n.Ac(1),n.Tb()),2&e){const e=t.$implicit;n.Cb(1),n.Cc(" ",e.reference," ")}}function F(e,t){1&e&&(n.Ub(0,"mat-header-cell",39),n.Ac(1," Quantity "),n.Tb())}function D(e,t){if(1&e&&(n.Ub(0,"mat-cell"),n.Ac(1),n.Tb()),2&e){const e=t.$implicit;n.Cb(1),n.Cc(" ",e.products.length," ")}}function S(e,t){1&e&&(n.Ub(0,"mat-header-cell",39),n.Ac(1," Amount "),n.Tb())}function w(e,t){if(1&e&&(n.Ub(0,"mat-cell"),n.Ac(1),n.Tb()),2&e){const e=t.$implicit;n.Cb(1),n.Cc(" ",e.amount," ")}}function x(e,t){1&e&&(n.Ub(0,"mat-header-cell",39),n.Ac(1," Customer "),n.Tb())}function P(e,t){if(1&e&&(n.Ub(0,"mat-cell"),n.Ac(1),n.Tb()),2&e){const e=t.$implicit;n.Cb(1),n.Cc(" ",e.customerName," ")}}function q(e,t){1&e&&(n.Ub(0,"mat-header-cell",39),n.Ac(1," Order Date "),n.Tb())}function z(e,t){if(1&e&&(n.Ub(0,"mat-cell"),n.Ac(1),n.hc(2,"date"),n.Tb()),2&e){const e=t.$implicit;n.Cb(1),n.Cc(" ",n.ic(2,1,e.orderDate)," ")}}function N(e,t){1&e&&(n.Ub(0,"mat-header-cell",39),n.Ac(1," Shipped Date "),n.Tb())}function L(e,t){if(1&e&&(n.Ub(0,"mat-cell"),n.Ac(1),n.hc(2,"date"),n.Tb()),2&e){const e=t.$implicit;n.Cb(1),n.Cc(" ",n.ic(2,1,e.shippedDate)," ")}}function E(e,t){1&e&&n.Pb(0,"mat-header-cell",40)}const R=function(e){return["/orders/edit/",e]};function $(e,t){if(1&e){const e=n.Vb();n.Ub(0,"mat-cell",40),n.Ub(1,"button",41),n.Ub(2,"mat-icon"),n.Ac(3,"edit"),n.Tb(),n.Tb(),n.Ub(4,"button",42),n.cc("click",(function(){n.tc(e);const r=t.$implicit;return n.gc().openDialog(r.id)})),n.Ub(5,"mat-icon"),n.Ac(6,"delete"),n.Tb(),n.Tb(),n.Tb()}if(2&e){const e=t.$implicit;n.Cb(1),n.mc("routerLink",n.oc(1,R,e.id))}}function V(e,t){1&e&&n.Pb(0,"mat-header-row")}function _(e,t){1&e&&n.Pb(0,"mat-row")}const j=function(){return["/orders/edit/",0]},B=function(){return[5,10]};let Q=(()=>{class e{constructor(e,t,r){this.orderService=e,this.dialog=t,this.snackBar=r,this.pageTitle="Orders",this.showImage=!1,this.listFilter={},this.displayedColumns=["reference","quantity","amount","customerName","orderDate","shippedDate","id"],this.dataSource=null,this.pager={},this.searchFilter={reference:"",amount:"",quantity:""}}toggleImage(){this.showImage=!this.showImage}applyFilter(e){e=(e=e.trim()).toLowerCase(),this.dataSource.filter=e}freshDataList(e){this.orders=e,this.orderList=e.map(e=>{let t=e;return e.customerName=e.customer.firstname+" "+e.customer.lastname,t}),this.totalAmount=this.orders.length,this.dataSource=new s.k(this.orderList),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}ngOnInit(){this.orderService.getOrders().subscribe(e=>{this.freshDataList(e)},e=>this.errorMessage=e),this.searchFilter={},this.listFilter={}}getOrders(e){this.orderService.getOrders().subscribe(e=>{this.freshDataList(e)},e=>this.errorMessage=e)}searchOrders(e){e&&this.orderService.getOrders().subscribe(t=>{this.orders=t,console.log(this.orders.length),this.orders=this.orders.filter(r=>{let a=!0;return Object.keys(e).forEach(t=>{a=a&&e[t]?r[t].toLocaleLowerCase().indexOf(e[t].toLocaleLowerCase())>-1:a}),this.freshDataList(t),a})},e=>this.errorMessage=e)}resetListFilter(){this.listFilter={},this.getOrders()}reset(){this.listFilter={},this.searchFilter={},this.getOrders()}resetSearchFilter(e){e.toggle(),this.searchFilter={},this.getOrders()}openSnackBar(e,t){this.snackBar.open(e,t,{duration:1500})}openDialog(e){let t=this.dialog.open(i.a,{data:{title:"Dialog",message:"Are you sure to delete this item?"}});t.disableClose=!0,t.afterClosed().subscribe(r=>{this.selectedOption=r,this.selectedOption===t.componentInstance.ACTION_CONFIRM&&this.orderService.deleteOrder(e).subscribe(()=>{this.orderService.getOrders().subscribe(e=>{this.freshDataList(e)},e=>this.errorMessage=e),this.openSnackBar("The item has been deleted successfully. ","Close")},e=>{this.errorMessage=e,console.log(this.errorMessage),this.openSnackBar("This item has not been deleted successfully. Please try again.","Close")})})}}return e.\u0275fac=function(t){return new(t||e)(n.Ob(m),n.Ob(u.b),n.Ob(h.a))},e.\u0275cmp=n.Ib({type:e,selectors:[["order-list"]],viewQuery:function(e,t){var r;1&e&&(n.Fc(o.a,!0),n.Fc(c.a,!0)),2&e&&(n.qc(r=n.dc())&&(t.paginator=r.first),n.qc(r=n.dc())&&(t.sort=r.first))},features:[n.Bb([i.a])],decls:83,vars:14,consts:[[1,"light",2,"height","100%"],[1,"view-card-title"],["mat-mini-fab","",2,"margin-right","10px","background-color","#e07c9e",3,"routerLink"],["mat-mini-fab","",2,"margin-right","10px","background-color","#a28b6e",3,"click"],["mat-mini-fab","",2,"margin-right","10px","background-color","darkgray",3,"click"],[1,"title-spacer"],["appearance","standard",1,"search-form-fileld"],["matInput","",3,"keyup"],["matSort","",3,"dataSource"],["table",""],["matColumnDef","reference"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","quantity"],["matColumnDef","amount"],["matColumnDef","customerName"],["matColumnDef","orderDate"],["matColumnDef","shippedDate"],["matColumnDef","id"],["style","justify-content:right;",4,"matHeaderCellDef"],["style","justify-content:right;",4,"matCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[3,"pageSize","pageSizeOptions","length"],["paginator",""],["position","end","position","end","dark","","mode","push","opened","false",1,"search-panel"],["sidenav",""],[1,"profile-card"],["mat-card-avatar","",1,"avatar"],[2,"margin-left","20px"],["matInput","","type","text","placeholder","Reference No.","name","reference",3,"ngModel","ngModelChange"],["reference",""],["matInput","","type","text","placeholder","Order Date","name","reference",3,"ngModel","ngModelChange"],["matInput","","type","text","placeholder","Customer","name","amount",3,"ngModel","ngModelChange"],["amount",""],["matInput","","type","text","placeholder","Customer Email","name","quantity",3,"ngModel","ngModelChange"],["quantity",""],["mat-raised-button","",2,"color","lightgrey","background-color","darkgreen","margin","5px",3,"click"],["mat-raised-button","",2,"color","lightgrey","background-color","darkred","margin","5px",3,"click"],["mat-sort-header",""],[2,"justify-content","right"],["mat-mini-fab","",2,"background-color","teal","min-height","30px","margin","5px",3,"routerLink"],["mat-mini-fab","",2,"background-color","lightblue","min-height","30px","margin","5px",3,"click"]],template:function(e,t){if(1&e){const e=n.Vb();n.Ub(0,"mat-card",0),n.Ub(1,"mat-card-header"),n.Ub(2,"mat-card-title",1),n.Ub(3,"h1"),n.Ac(4),n.Tb(),n.Tb(),n.Tb(),n.Ub(5,"mat-toolbar"),n.Ub(6,"mat-toolbar-row"),n.Ub(7,"button",2),n.Ub(8,"mat-icon"),n.Ac(9,"add"),n.Tb(),n.Tb(),n.Ub(10,"button",3),n.cc("click",(function(){return n.tc(e),n.rc(51).toggle()})),n.Ub(11,"mat-icon"),n.Ac(12,"search"),n.Tb(),n.Tb(),n.Ub(13,"button",4),n.cc("click",(function(){return t.reset()})),n.Ub(14,"mat-icon"),n.Ac(15,"refresh"),n.Tb(),n.Tb(),n.Pb(16,"span",5),n.Ub(17,"mat-form-field",6),n.Ub(18,"mat-label"),n.Ac(19,"Filter"),n.Tb(),n.Ub(20,"input",7),n.cc("keyup",(function(e){return t.applyFilter(e.target.value)})),n.Tb(),n.Ub(21,"mat-icon"),n.Ac(22,"filter_list"),n.Tb(),n.Tb(),n.Tb(),n.Tb(),n.Ub(23,"mat-table",8,9),n.Sb(25,10),n.zc(26,M,2,0,"mat-header-cell",11),n.zc(27,k,2,1,"mat-cell",12),n.Rb(),n.Sb(28,13),n.zc(29,F,2,0,"mat-header-cell",11),n.zc(30,D,2,1,"mat-cell",12),n.Rb(),n.Sb(31,14),n.zc(32,S,2,0,"mat-header-cell",11),n.zc(33,w,2,1,"mat-cell",12),n.Rb(),n.Sb(34,15),n.zc(35,x,2,0,"mat-header-cell",11),n.zc(36,P,2,1,"mat-cell",12),n.Rb(),n.Sb(37,16),n.zc(38,q,2,0,"mat-header-cell",11),n.zc(39,z,3,3,"mat-cell",12),n.Rb(),n.Sb(40,17),n.zc(41,N,2,0,"mat-header-cell",11),n.zc(42,L,3,3,"mat-cell",12),n.Rb(),n.Sb(43,18),n.zc(44,E,1,0,"mat-header-cell",19),n.zc(45,$,7,3,"mat-cell",20),n.Rb(),n.zc(46,V,1,0,"mat-header-row",21),n.zc(47,_,1,0,"mat-row",22),n.Tb(),n.Pb(48,"mat-paginator",23,24),n.Tb(),n.Ub(50,"mat-sidenav",25,26),n.Ub(52,"mat-card",27),n.Ub(53,"mat-card-header"),n.Ub(54,"div",28),n.Ub(55,"mat-icon"),n.Ac(56,"search"),n.Tb(),n.Tb(),n.Ub(57,"mat-card-title"),n.Ac(58," Advanced Search "),n.Tb(),n.Tb(),n.Tb(),n.Ub(59,"mat-nav-list",29),n.Ub(60,"mat-form-field"),n.Ub(61,"input",30,31),n.cc("ngModelChange",(function(e){return t.searchFilter.reference=e})),n.Tb(),n.Tb(),n.Ub(63,"mat-form-field"),n.Ub(64,"input",32,31),n.cc("ngModelChange",(function(e){return t.searchFilter.orderDate=e})),n.Tb(),n.Tb(),n.Ub(66,"mat-form-field"),n.Ub(67,"input",33,34),n.cc("ngModelChange",(function(e){return t.searchFilter.customerName=e})),n.Tb(),n.Tb(),n.Ub(69,"mat-form-field"),n.Ub(70,"input",35,36),n.cc("ngModelChange",(function(e){return t.searchFilter.customerEmail=e})),n.Tb(),n.Tb(),n.Tb(),n.Pb(72,"mat-divider"),n.Ub(73,"mat-card-header"),n.Ub(74,"mat-action-list"),n.Ub(75,"button",37),n.cc("click",(function(){n.tc(e);const r=n.rc(51);return t.searchOrders(t.searchFilter),r.toggle()})),n.Ub(76,"mat-icon"),n.Ac(77,"search"),n.Tb(),n.Ac(78,"Search "),n.Tb(),n.Ub(79,"button",38),n.cc("click",(function(){n.tc(e);const r=n.rc(51);return t.resetSearchFilter(r)})),n.Ub(80,"mat-icon"),n.Ac(81,"refresh"),n.Tb(),n.Ac(82,"Reset "),n.Tb(),n.Tb(),n.Tb(),n.Tb()}2&e&&(n.Cb(4),n.Bc(t.pageTitle),n.Cb(3),n.mc("routerLink",n.nc(12,j)),n.Cb(16),n.mc("dataSource",t.dataSource),n.Cb(23),n.mc("matHeaderRowDef",t.displayedColumns),n.Cb(1),n.mc("matRowDefColumns",t.displayedColumns),n.Cb(1),n.mc("pageSize",10)("pageSizeOptions",n.nc(13,B))("length",t.totalAmount),n.Cb(13),n.mc("ngModel",t.searchFilter.reference),n.Cb(3),n.mc("ngModel",t.searchFilter.orderDate),n.Cb(3),n.mc("ngModel",t.searchFilter.customerName),n.Cb(3),n.mc("ngModel",t.searchFilter.customerEmail))},directives:[p.a,p.e,p.h,g.a,g.c,f.b,a.g,C.a,y.c,y.f,T.b,s.j,c.a,s.c,s.e,s.b,s.g,s.i,o.a,U.a,p.c,v.f,O.b,O.k,O.n,A.a,v.a,s.d,c.b,s.a,s.f,s.h],pipes:[I.f],styles:["thead[_ngcontent-%COMP%]{color:#337ab7}.title-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.search-form-fileld[_ngcontent-%COMP%]{margin-right:20px}.table-responsive[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:300px}.mat-table[_ngcontent-%COMP%]{overflow:auto}.filter-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:200px}"]}),e})(),G=(()=>{class e{constructor(e){this.router=e}canActivate(e){let t=+e.url[1].path;return!(isNaN(t)||t<1)||(alert("Invalid order Id"),this.router.navigate(["/orders"]),!1)}}return e.\u0275fac=function(t){return new(t||e)(n.Yb(a.f))},e.\u0275prov=n.Kb({token:e,factory:e.\u0275fac}),e})(),H=(()=>{class e{canDeactivate(e){if(e.orderForm.dirty){let t=e.orderForm.get("reference").value||"New Order";return confirm(`Navigate away and lose all changes to ${t}?`)}return!0}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=n.Kb({token:e,factory:e.\u0275fac}),e})();r("t/4F"),r("Xr5q"),r("6Br6");var K=r("WyWZ"),J=r("QEVK"),X=(r("nscy"),r("JiIv"),r("8/IB")),Y=(r("qvFY"),r("dvAK"),r("L1xU"),r("0AqG"));function W(e,t){if(1&e&&(n.Ub(0,"mat-error"),n.Ac(1),n.Tb()),2&e){const e=n.gc();n.Cb(1),n.Cc(" ",e.displayMessage.product," ")}}function Z(e,t){if(1&e&&(n.Ub(0,"mat-error"),n.Ac(1),n.Tb()),2&e){const e=n.gc();n.Cb(1),n.Cc(" ",e.displayMessage.price," ")}}function ee(e,t){if(1&e&&(n.Ub(0,"mat-error"),n.Ac(1),n.Tb()),2&e){const e=n.gc();n.Cb(1),n.Cc(" ",e.displayMessage.quantity," ")}}r("d7gL");let te=(()=>{class e{constructor(e,t,r,a,i,o,c){this.fb=e,this.route=t,this.router=r,this.productService=a,this.customerService=i,this.data=o,this.dialogRef=c,this.ACTION_CANCEL="CANCEL",this.ACTION_SAVE="SAVE",this.pageTitle="Add product to order",this.displayMessage={},this.validationMessages={product:{required:"Product first name is required.",minlength:"Product first name must be at least one characters.",maxlength:"Product first name cannot exceed 100 characters."},price:{range:"Rewards of the product must be between 1 (lowest) and 9999 (highest)."},quantity:{range:"Rewards of the product must be between 1 (lowest) and 20 (highest)."},customerId:{range:"Rewards of the product must be between 1 (lowest) and 99999 (highest)."}},this.genericValidator=new J.a(this.validationMessages)}ngOnInit(){this.productForm=this.fb.group({product:["",[O.r.required,O.r.minLength(3),O.r.maxLength(100)]],price:["",K.a.range(1,99999)],quantity:["",K.a.range(1,20)],customerId:["",K.a.range(1,9999999)],membership:!1}),this.sub=this.route.params.subscribe(e=>{this.getProduct(+e.id)}),this.getCustomers()}ngOnDestroy(){this.sub.unsubscribe()}ngAfterViewInit(){let e=this.formInputElements.map(e=>d.a.fromEvent(e.nativeElement,"blur"));d.a.merge(this.productForm.valueChanges,...e).debounceTime(800).subscribe(()=>{this.displayMessage=this.genericValidator.processMessages(this.productForm)})}getProduct(e){this.productService.getProduct(e).subscribe(e=>this.onProductRetrieved(e),e=>this.errorMessage=e)}getCustomers(){this.customerService.getCustomers().subscribe(e=>{this.customers=e},e=>this.errorMessage=e)}onProductRetrieved(e){this.productForm&&this.productForm.reset(),this.product=e,this.pageTitle=0===this.product.id?"Add Product":`Edit Product: ${this.product.productName} ${this.product.unitPrice}`,this.productForm.patchValue({product:this.product.productName,price:this.product.unitPrice,quantity:this.product.unitInStock})}deleteProduct(){0===this.product.id?this.onSaveComplete():confirm(`Really delete the product: ${this.product.productName}?`)&&this.productService.deleteProduct(this.product.id).subscribe(()=>this.onSaveComplete(),e=>this.errorMessage=e)}saveProduct(){if(this.productForm.dirty&&this.productForm.valid){let e=Object.assign({},this.product,this.productForm.value);this.productService.saveProduct(e).subscribe(()=>this.onSaveComplete(),e=>this.errorMessage=e)}else this.productForm.dirty||this.onSaveComplete()}onSaveComplete(){this.productForm.reset(),this.router.navigate(["/products"])}}return e.\u0275fac=function(t){return new(t||e)(n.Ob(O.c),n.Ob(a.a),n.Ob(a.f),n.Ob(X.a),n.Ob(Y.a),n.Ob(u.a),n.Ob(u.g))},e.\u0275cmp=n.Ib({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var r;1&e&&n.Fc(O.d,!0,n.l),2&e&&n.qc(r=n.dc())&&(t.formInputElements=r)},decls:20,vars:7,consts:[["mat-dialog-title",""],["novalidate","",1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"dialog-field"],["matInput","","type","text","placeholder","Product (required)","formControlName","product"],["productId",""],[4,"ngIf"],["matInput","","placeholder","Amount","id","priceId","type","number","placeholder","Price (required)","formControlName","price"],["matInput","","placeholder","Quantity","id","quantityId","type","number","placeholder","Quantity (required)","formControlName","quantity"],["mat-raised-button","",3,"mat-dialog-close"]],template:function(e,t){1&e&&(n.Ub(0,"div",0),n.Ac(1),n.Tb(),n.Ub(2,"mat-dialog-content"),n.Ub(3,"form",1),n.cc("ngSubmit",(function(){return t.saveProduct()})),n.Ub(4,"mat-form-field",2),n.Pb(5,"input",3,4),n.zc(7,W,2,1,"mat-error",5),n.Tb(),n.Ub(8,"mat-form-field",2),n.Pb(9,"input",6),n.zc(10,Z,2,1,"mat-error",5),n.Tb(),n.Ub(11,"mat-form-field",2),n.Pb(12,"input",7),n.zc(13,ee,2,1,"mat-error",5),n.Tb(),n.Tb(),n.Tb(),n.Ub(14,"mat-dialog-actions"),n.Ub(15,"button",8),n.Ac(16,"Confirm"),n.Tb(),n.Ub(17,"button",8),n.Ac(18,"Cancel"),n.Tb(),n.Tb(),n.Ac(19,">")),2&e&&(n.Cb(1),n.Cc(" ",t.pageTitle,"\n"),n.Cb(2),n.mc("formGroup",t.productForm),n.Cb(4),n.mc("ngIf",t.displayMessage.product),n.Cb(3),n.mc("ngIf",t.displayMessage.price),n.Cb(3),n.mc("ngIf",t.displayMessage.quantity),n.Cb(2),n.mc("mat-dialog-close",t.ACTION_SAVE),n.Cb(2),n.mc("mat-dialog-close",t.ACTION_CANCEL))},directives:[u.h,u.e,O.s,O.l,O.f,y.c,T.b,O.b,O.k,O.d,I.n,O.o,u.c,f.b,u.d,y.b],encapsulation:2}),e})();var re=r("0MNC"),ae=r("zkoq"),ie=r("d3UM"),oe=r("iadO"),ce=r("FKr1");function se(e,t){if(1&e&&(n.Ub(0,"mat-option",30),n.Ac(1),n.Tb()),2&e){const e=t.$implicit;n.mc("value",e.id),n.Cb(1),n.Dc(" ",e.firstname," ",e.lastname," ")}}function ne(e,t){if(1&e&&(n.Ub(0,"mat-error"),n.Ac(1),n.Tb()),2&e){const e=n.gc();n.Cb(1),n.Cc(" ",e.displayMessage.reference," ")}}function de(e,t){if(1&e&&(n.Ub(0,"mat-error"),n.Ac(1),n.Tb()),2&e){const e=n.gc();n.Cb(1),n.Cc(" ",e.displayMessage.amount," ")}}function le(e,t){if(1&e&&(n.Ub(0,"mat-error"),n.Ac(1),n.Tb()),2&e){const e=n.gc();n.Cb(1),n.Cc(" ",e.displayMessage.quantity," ")}}function be(e,t){if(1&e&&(n.Ub(0,"mat-error",31),n.Ac(1),n.Tb()),2&e){const e=n.gc();n.Cb(1),n.Cc(" ",e.displayMessage.address," ")}}function me(e,t){if(1&e&&(n.Ub(0,"mat-error",31),n.Ac(1),n.Tb()),2&e){const e=n.gc();n.Cb(1),n.Cc(" ",e.displayMessage.city," ")}}function ue(e,t){if(1&e&&(n.Ub(0,"mat-error",31),n.Ac(1),n.Tb()),2&e){const e=n.gc();n.Cb(1),n.Cc(" ",e.displayMessage.country," ")}}function he(e,t){if(1&e&&(n.Ub(0,"mat-error",31),n.Ac(1),n.Tb()),2&e){const e=n.gc();n.Cb(1),n.Cc(" ",e.displayMessage.zipcode," ")}}function pe(e,t){if(1&e){const e=n.Vb();n.Ub(0,"mat-list-item",34),n.Ub(1,"mat-icon",35),n.Ac(2,"folder"),n.Tb(),n.Ub(3,"h4",36),n.Ac(4),n.Tb(),n.Ub(5,"button",37),n.cc("click",(function(){n.tc(e);const r=t.$implicit;return n.gc(2).openDialog(r)})),n.Ub(6,"mat-icon"),n.Ac(7,"delete"),n.Tb(),n.Tb(),n.Ub(8,"p",36),n.Ac(9),n.hc(10,"number"),n.Tb(),n.Tb()}if(2&e){const e=t.$implicit;n.Cb(4),n.Cc("",e.productName," "),n.Cb(5),n.Cc(" AUD $",n.jc(10,2,e.unitPrice,"0.00")," ")}}function ge(e,t){if(1&e&&(n.Ub(0,"mat-list"),n.Ub(1,"h3",32),n.Ac(2,"Products"),n.Tb(),n.zc(3,pe,11,5,"mat-list-item",33),n.Tb()),2&e){const e=n.gc();n.Cb(3),n.mc("ngForOf",e.order.products)}}function fe(e,t){if(1&e&&(n.Ub(0,"div",38),n.Ac(1),n.Tb()),2&e){const e=n.gc();n.Cb(1),n.Bc(e.errorMessage)}}const Ce=function(){return["/orders"]};let ye=(()=>{class e{constructor(e,t,r,a,i,o,c){this.fb=e,this.route=t,this.router=r,this.orderService=a,this.customerService=i,this.dialog=o,this.breakpointObserver=c,this.pageTitle="Update Order",this.order={},this.fieldColspan=4,this.displayMessage={},this.validationMessages={reference:{required:"Order reference is required.",minlength:"Order reference must be at least one characters.",maxlength:"Order reference cannot exceed 100 characters."},amount:{required:"Order amount is required.",range:"Amount of the order must be between 1 (lowest) and 9999 (highest)."},quantity:{required:"Order quantity is required.",range:"Quantity of the order must be between 1 (lowest) and 20 (highest)."},customerId:{required:"Customer is required."}},c.observe([re.b.HandsetLandscape,re.b.HandsetPortrait]).subscribe(e=>{this.onScreensizeChange()}),this.genericValidator=new J.a(this.validationMessages)}ngOnInit(){this.orderForm=this.fb.group({reference:["",[O.r.required,O.r.minLength(3),O.r.maxLength(100)]],amount:["",[O.r.required,K.a.range(1,99999)]],quantity:["",[O.r.required,K.a.range(1,20)]],orderDate:[""],shippedDate:[""],address:["",[O.r.required]],city:["",[O.r.required]],country:["",[O.r.required]],zipcode:["",[O.r.required]],customerId:["",O.r.required],products:this.fb.array([]),membership:!1}),this.sub=this.route.params.subscribe(e=>{this.getOrder(+e.id)}),this.getCustomers()}ngOnDestroy(){this.sub.unsubscribe()}ngAfterViewInit(){let e=this.formInputElements.map(e=>d.a.fromEvent(e.nativeElement,"blur"));d.a.merge(this.orderForm.valueChanges,...e).debounceTime(800).subscribe(()=>{this.displayMessage=this.genericValidator.processMessages(this.orderForm)})}getOrder(e){this.orderService.getOrder(e).subscribe(e=>this.onOrderRetrieved(e),e=>this.errorMessage=e)}getCustomers(){this.customerService.getCustomers().subscribe(e=>{this.customers=e},e=>this.errorMessage=e)}onOrderRetrieved(e){this.orderForm&&this.orderForm.reset(),this.order=e,this.pageTitle=0===this.order.id?"Add Order":`Update Order: ${this.order.reference} `,this.orderForm.patchValue({reference:this.order.reference,amount:this.order.amount,quantity:this.order.products.length,orderDate:new Date(this.order.orderDate),shippedDate:new Date(this.order.shippedDate),address:this.order.shipAddress.address,city:this.order.shipAddress.city,country:this.order.shipAddress.country,zipcode:this.order.shipAddress.zipcode,customerId:this.order.customerId,membership:this.order.membership});const t=this.order.products.map(e=>this.fb.group({productName:[e.productName],price:[e.unitPrice]})),r=this.fb.array(t);this.orderForm.setControl("products",r)}saveOrder(){if(this.orderForm.dirty&&this.orderForm.valid){const e=Object.assign({},this.order,this.orderForm.value);this.orderService.saveOrder(e).subscribe(()=>this.onSaveComplete(),e=>this.errorMessage=e)}else!this.orderForm.dirty&&this.orderForm.valid&&this.onSaveComplete()}onSaveComplete(){this.orderForm.reset(),this.router.navigate(["/orders"])}addProduct(e){let t=this.dialog.open(te,{height:"400px",width:"600px",data:{title:"Dialog"}});t.disableClose=!0,t.afterClosed().subscribe(e=>{}),e.preventDefault()}openDialog(e){let t=this.dialog.open(i.a,{data:{title:"Dialog",message:"Are you sure to delete this item?"}});t.disableClose=!0,t.afterClosed().subscribe(()=>{})}onScreensizeChange(){const e=this.breakpointObserver.isMatched("(max-width: 599px)"),t=this.breakpointObserver.isMatched("(max-width: 959px)");console.log(` isLess600  ${e} \n        isLess1000 ${t}  `),this.fieldColspan=t?e?12:6:3}deleteProduct(){}}return e.\u0275fac=function(t){return new(t||e)(n.Ob(O.c),n.Ob(a.a),n.Ob(a.f),n.Ob(m),n.Ob(Y.a),n.Ob(u.b),n.Ob(re.a))},e.\u0275cmp=n.Ib({type:e,selectors:[["order-form"]],viewQuery:function(e,t){var r;1&e&&n.Fc(O.d,!0,n.l),2&e&&n.qc(r=n.dc())&&(t.formInputElements=r)},features:[n.Bb([te])],decls:67,vars:32,consts:[["novalidate","",3,"formGroup","ngSubmit"],[2,"background-color","#FFF"],[1,"view-card-title"],[1,"title-spacer"],["mat-mini-fab","","type","submit",1,"primary",2,"margin-right","10px","background-color","darkgray",3,"disabled"],["mat-mini-fab","",1,"",2,"margin-right","10px",3,"routerLink"],["mat-mini-fab","",1,"accent",2,"margin-right","10px","background-color","#e07c9e",3,"click"],[2,"margin","5 0 5 0px"],[1,"form-card"],["cols","12","rowHeight","80px"],[3,"colspan"],["appearance","outline",1,"form-field"],["placeholder","Select Customer","formControlName","customerId",3,"value","valueChange"],["customerIdId",""],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","Reference No","id","referenceId","type","text","placeholder","Reference No. (required)","formControlName","reference"],[4,"ngIf"],["matInput","","placeholder","Amount","id","amountId","type","number","placeholder","Price (required)","formControlName","amount"],["matInput","","placeholder","Quantity","id","quantityId","type","number","placeholder","Quantity (required)","formControlName","quantity"],["matInput","","placeholder","Order date",3,"matDatepicker","value"],["matSuffix","",3,"for"],["orderpickerId",""],["matInput","","placeholder","Shipped date",3,"matDatepicker","value"],["shippedDateId",""],["matInput","","placeholder","Address","id","addressId","type","text","formControlName","address","disabled",""],["class","help-block",4,"ngIf"],["matInput","","placeholder","City","id","cityId","type","text","formControlName","city"],["matInput","","placeholder","Country","id","countryId","type","text","formControlName","country"],["matInput","","placeholder","Zipcode","id","zipcodeId","type","text","formControlName","zipcode"],["class","has-error",4,"ngIf"],[3,"value"],[1,"help-block"],["mat-subheader",""],["style","background-color:#e7ecf7; padding-bottom:2px; margin-bottom:5px;",4,"ngFor","ngForOf"],[2,"background-color","#e7ecf7","padding-bottom","2px","margin-bottom","5px"],["mat-list-icon",""],["mat-line",""],["mat-mini-fab","",2,"background-color","lightgrey","float","right",3,"click"],[1,"has-error"]],template:function(e,t){if(1&e&&(n.Ub(0,"form",0),n.cc("ngSubmit",(function(){return t.saveOrder()})),n.Ub(1,"mat-card"),n.Ub(2,"mat-toolbar",1),n.Ub(3,"mat-toolbar-row"),n.Ub(4,"span",2),n.Ac(5),n.Tb(),n.Pb(6,"span",3),n.Ub(7,"mat-card-actions"),n.Ub(8,"button",4),n.Ub(9,"mat-icon"),n.Ac(10,"save"),n.Tb(),n.Tb(),n.Ub(11,"button",5),n.Ub(12,"mat-icon"),n.Ac(13,"cancel"),n.Tb(),n.Tb(),n.Ub(14,"button",6),n.cc("click",(function(e){return t.addProduct(e)})),n.Ub(15,"mat-icon"),n.Ac(16,"add"),n.Tb(),n.Tb(),n.Tb(),n.Tb(),n.Tb(),n.Ub(17,"mat-card-content",7),n.Ub(18,"div",8),n.Ub(19,"mat-grid-list",9),n.Ub(20,"mat-grid-tile",10),n.Ub(21,"mat-form-field",11),n.Ub(22,"mat-select",12,13),n.cc("valueChange",(function(e){return t.order.customerId=e})),n.zc(24,se,2,3,"mat-option",14),n.Tb(),n.Tb(),n.Tb(),n.Ub(25,"mat-grid-tile",10),n.Ub(26,"mat-form-field",11),n.Pb(27,"input",15),n.zc(28,ne,2,1,"mat-error",16),n.Tb(),n.Tb(),n.Ub(29,"mat-grid-tile",10),n.Ub(30,"mat-form-field",11),n.Pb(31,"input",17),n.zc(32,de,2,1,"mat-error",16),n.Tb(),n.Tb(),n.Ub(33,"mat-grid-tile",10),n.Ub(34,"mat-form-field",11),n.Pb(35,"input",18),n.zc(36,le,2,1,"mat-error",16),n.Tb(),n.Tb(),n.Ub(37,"mat-grid-tile",10),n.Ub(38,"mat-form-field",11),n.Pb(39,"input",19),n.Pb(40,"mat-datepicker-toggle",20),n.Pb(41,"mat-datepicker",null,21),n.Tb(),n.Tb(),n.Ub(43,"mat-grid-tile",10),n.Ub(44,"mat-form-field",11),n.Pb(45,"input",22),n.Pb(46,"mat-datepicker-toggle",20),n.Pb(47,"mat-datepicker",null,23),n.Tb(),n.Tb(),n.Ub(49,"mat-grid-tile",10),n.Ub(50,"mat-form-field",11),n.Pb(51,"input",24),n.zc(52,be,2,1,"mat-error",25),n.Tb(),n.Tb(),n.Ub(53,"mat-grid-tile",10),n.Ub(54,"mat-form-field",11),n.Pb(55,"input",26),n.zc(56,me,2,1,"mat-error",25),n.Tb(),n.Tb(),n.Ub(57,"mat-grid-tile",10),n.Ub(58,"mat-form-field",11),n.Pb(59,"input",27),n.zc(60,ue,2,1,"mat-error",25),n.Tb(),n.Tb(),n.Ub(61,"mat-grid-tile",10),n.Ub(62,"mat-form-field",11),n.Pb(63,"input",28),n.zc(64,he,2,1,"mat-error",25),n.Tb(),n.Tb(),n.Tb(),n.Tb(),n.zc(65,ge,4,1,"mat-list",16),n.zc(66,fe,2,1,"div",29),n.Tb(),n.Tb(),n.Tb()),2&e){const e=n.rc(42),r=n.rc(48);n.mc("formGroup",t.orderForm),n.Cb(5),n.Cc(" ",t.pageTitle,""),n.Cb(3),n.mc("disabled",!t.orderForm.valid),n.Cb(3),n.mc("routerLink",n.nc(31,Ce)),n.Cb(9),n.mc("colspan",t.fieldColspan),n.Cb(2),n.mc("value",t.order.customerId),n.Cb(2),n.mc("ngForOf",t.customers),n.Cb(1),n.mc("colspan",t.fieldColspan),n.Cb(3),n.mc("ngIf",t.displayMessage.reference),n.Cb(1),n.mc("colspan",t.fieldColspan),n.Cb(3),n.mc("ngIf",t.displayMessage.amount),n.Cb(1),n.mc("colspan",t.fieldColspan),n.Cb(3),n.mc("ngIf",t.displayMessage.quantity),n.Cb(1),n.mc("colspan",t.fieldColspan),n.Cb(2),n.mc("matDatepicker",e)("value",t.order.orderDate),n.Cb(1),n.mc("for",e),n.Cb(3),n.mc("colspan",t.fieldColspan),n.Cb(2),n.mc("matDatepicker",r)("value",t.order.shippedDate),n.Cb(1),n.mc("for",r),n.Cb(3),n.mc("colspan",t.fieldColspan),n.Cb(3),n.mc("ngIf",t.displayMessage.address),n.Cb(1),n.mc("colspan",t.fieldColspan),n.Cb(3),n.mc("ngIf",t.displayMessage.city),n.Cb(1),n.mc("colspan",t.fieldColspan),n.Cb(3),n.mc("ngIf",t.displayMessage.country),n.Cb(1),n.mc("colspan",t.fieldColspan),n.Cb(3),n.mc("ngIf",t.displayMessage.zipcode),n.Cb(1),n.mc("ngIf",null!=t.order&&null!=t.order.products),n.Cb(1),n.mc("ngIf",t.errorMessage)}},directives:[O.s,O.l,O.f,p.a,g.a,g.c,p.b,f.b,C.a,a.g,p.d,ae.a,ae.c,y.c,ie.a,O.k,O.d,I.m,T.b,O.b,I.n,O.o,oe.b,oe.d,y.g,oe.a,ce.n,y.b,v.a,v.e,v.c,v.b,ce.j],pipes:[I.g],styles:[".title-spacer[_ngcontent-%COMP%] {\n      flex: 1 1 auto;\n    }\n  .form-field[_ngcontent-%COMP%]{\n      width: 100%;\n      margin-left: 20px;\n      margin-right: 20px;\n    }"]}),e})();var Te=r("PCNd"),Ue=r("5dmV");let ve=(()=>{class e{}return e.\u0275mod=n.Mb({type:e}),e.\u0275inj=n.Lb({factory:function(t){return new(t||e)},providers:[m,G,H,Y.a,X.a],imports:[[Te.a,Ue.a,a.i.forChild([{path:"",component:Q},{path:"edit/:id",canDeactivate:[H],component:ye}])]]}),e})()}}]);